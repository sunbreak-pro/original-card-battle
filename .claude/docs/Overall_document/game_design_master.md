# オリジナル カードバトル RPG 全体設計書 V3.0

## 更新履歴

- V3.0: **残機システム導入** - 探索回数制限を残機（復帰可能回数）に変更、転移石統一、死亡時魂100%獲得
- V2.0: 設計の根本的変更 - ローグライト要素削除、持ち帰り型ダンジョン RPG へ転換

---

## 1. ゲームコンセプト

### 1.1 ジャンルの再定義

> **持ち帰り型ダンジョン RPG × カードバトル**
> 生還を目指す、計画的な探索と成長

**参考作品:**

- 風来のシレン（持ち帰り型）
- Slay the Spire（カードバトル）
- ダークソウル（死亡ペナルティの重さ）

---

### 1.2 設計思想の転換

```
【持ち帰り型の利点】
探索 → 生還 → 装備・アイテム・Gold・魂を保持 → 成長
       ↓
     死亡 → 全ロスト（装備・アイテム・Gold）+ 魂100%獲得 + 残機-1
       ↓
   BaseCampの装備・カード・Goldは保持

利点:
- リスク・リターンが明確
- 生還の達成感
- 持ち帰るタイミングの戦略性
- 残機システムによる緊張感
```

---

## 2. ゲームの核心メカニクス

### 2.1 コアループ

```
┌─────────────────────────────────────────────┐
│                                             │
│  BaseCamp（安全地帯）                         │
│  ├─ 装備強化（Blacksmith）                    │
│  ├─ 装備購入（Shop）                          │
│  ├─ デッキ編成（Library）                     │
│  └─ 魂の残滓でレベルアップ（Sanctuary）         │
│                                             │
└──────────────┬──────────────────────────────┘
               │ 装備・デッキを選んで出発
               ↓
┌─────────────────────────────────────────────┐
│  Dungeon（危険地帯）                          │
│  ├─ 戦闘 → 魔石・装備・カード熟練度上昇・魂を獲得  │
│  ├─ 深層へ進むか、帰還するか判断                 │
│  └─ 2つの選択肢:                              │
│     [A] 生還 → 全て持ち帰り                    │
│     [B] 死亡 → 全ロスト + 魂獲得 + 残機-1       │
└──────────────┬──────────────────────────────┘
               │
               ↓
      [A] 生還の場合:
      - BaseCampに装備・イベント入手でのGold・魂を持ち帰り
      - 次の探索に向けた強化
      - 残機変化なし

      [B] 死亡の場合:
      - 所有アイテム・装備全ロスト
      - 獲得したGoldもゼロ
      - 魂の残滓は100%獲得（累計に加算）
      - 残機-1
      - BaseCampの装備・カード・Goldは保持
               ↓
      残機 > 0 → BaseCampに戻る
      残機 = 0 → ゲームオーバー（完全リセット）
```

---

### 2.2 リスク・リターンの設計

#### 生還のメリット（リターン）

| 持ち帰れるもの | 説明                           |
| -------------- | ------------------------------ |
| Gold           | Dungeon 内で獲得した Gold 全額 |
| 装備           | Dungeon 内で獲得した装備       |
| アイテム       | Dungeon 内で拾った消耗品       |
| 魂の残滓       | 魔物を倒して獲得した経験値     |

※ ダンジョン内での gold の入手は特定のイベントのみ。戦闘報酬で gold は入手できない。

**生還の判断ポイント:**

- HP 残量
- 装備の耐久度（AP）
- 手持ちの回復アイテム
- 高レベルの武器や魔石の入手
- 次の深度の危険性

#### 死亡のデメリット（リスク）

| ロストするもの       | 説明                                       |
| -------------------- | ------------------------------------------ |
| **所有装備全て**     | 持ち込んだ装備・獲得した装備、全てロスト   |
| **所有アイテム全て** | 持ち込んだ消耗品・拾った消耗品、全てロスト |
| 獲得した Gold        | Dungeon 内で獲得した Gold ゼロに           |
| **残機 1つ**         | 残機が1減少                                |

**死亡時に獲得できるもの（重要）:**

| 獲得できるもの   | 説明                                       |
| ---------------- | ------------------------------------------ |
| **魂の残滓100%** | その探索で獲得した魂は全て累計に加算される |

**保持されるもの（重要）:**

- BaseCamp に保管している装備
- BaseCamp の Gold 残高
- 過去の探索で持ち帰った魂の残滓（累計レベル）
- Sanctuary で解放した恒久強化

**設計意図:**

- 死亡は非常に痛いが、魂は確実に獲得できる
- 持ち込み装備のリスク管理が重要
- 「この装備を持ち込むべきか」のジレンマ
- 残機システムによる最終的な緊張感

---

### 2.3 残機（復帰可能回数）システム

#### 制限の目的

**なぜ残機が必要か:**

- 無限の試行錯誤を防ぐ
- 各死亡に重みを持たせる
- プレイヤーに慎重なプレイを促す
- ゲーム全体の緊張感を維持

#### 残機の仕組み

**基本ルール:**

```
難易度別残機上限:
- Hard: 2
- Normal: 3
- Easy: 3

残機減少タイミング: 死亡時のみ
残機回復: なし

残機0で死亡 → ゲームオーバー（完全リセット）
```

**残機の変動:**

| 状況                 | 残機変化 | 備考   |
| -------------------- | -------- | ------ |
| 探索開始             | 変化なし |        |
| 帰還ルートで生還     | 変化なし |        |
| 転移石で生還         | 変化なし |        |
| Depth1-4で死亡       | **-1**   |        |
| 深淵（Depth5）で死亡 | **-1**   |        |
| 深淵ボス撃破後脱出   | 変化なし | クリア |

#### 難易度による変動

| 難易度 | 残機上限 | 想定プレイスタイル       |
| ------ | -------- | ------------------------ |
| Easy   | 3        | ある程度の試行錯誤が可能 |
| Normal | 3        | 計画的な探索が必要       |
| Hard   | 2        | 失敗が許されない         |

---

## 3. 進行システムの全体像

### 3.1 成長の軸

ゲーム内の成長は**3 つの軸**で構成されます：

#### (1) 装備の成長（ラン内 + 恒久）

**特徴:**

- BaseCamp で強化・購入
- Dungeon に持ち込む
- 生還すれば持ち帰り、**死亡すればロスト**

**成長要素:**

- 装備レベル（Lv0-3）
- 装備品質（poor/normal/good/master）
- 装備の種類（Common → Legendary）

**リスク:**

- 高レベル装備を持ち込む → **死亡時のロスト大**
- 低レベル装備で挑む → クリアが困難

#### (2) カードの成長（恒久）

**特徴:**

- カード自体はロストしない（図鑑に記録）
- 使用回数で熟練度が上がる
- 熟練度でカードが進化

**成長要素:**

- カード熟練度（Lv1-5）
- カード進化（新たな効果・分岐）

**保持:**

- カードの習得状態はロストしない
- デッキ構成は Library で保存

#### (3) 魂の残滓（経験値システム・恒久）

**特徴:**

- 魔物を倒すと魂を獲得
- **生還すれば100%累計に加算**
- **死亡しても100%累計に加算**（V3.0変更）

**成長要素:**

- Sanctuary でスキルツリー解放
- 基礎ステータス強化（HP/インベントリ容量）
- 特殊能力解放（実装検討中）

**経験値の計算:**

```typescript
獲得魂のレアリティ = 敵の強さ
経験値量（累計魂）= 獲得魂を換算
魔物の魂:（拡張可能）
- 雑魚（下位）: 小魂（=累計魂*10）
- 雑魚（中位）: 中魂（=累計魂*50）
- 雑魚（上位）: 大魂（=累計魂*100）
- 強敵（フロアボス）: 荘厳なる鬼魂（=累計魂*500）
- ボス（深層にいる邪神）: 荒ぶる神魂（=累計魂*1000）
```

**レベルアップ:**

```
累計魂  スキルポイント
0-99    0
100-299  1
300-599  2
600-999  3
1000+    4
...
```

---

### 3.2 ゲーム全体の流れ

#### フェーズ 1: 序盤（残機3→2程度まで）

**目標:** 基礎を固める

```
- Shopで初期装備を購入
- Blacksmithで装備を強化（Lv1程度）
- Libraryでデッキを構築
- 深度1-2を探索し、魂と熟練度を蓄積
- 死亡しても魂は獲得できるので成長は続く
```

#### フェーズ 2: 中盤（残機2程度）

**目標:** 戦力を強化

```
- 持ち帰ったGoldで装備をアップグレード
- Blacksmithで品質上昇（ガチャ）に挑戦
- Sanctuaryでスキルツリー解放
- 深度3-4に挑戦
- 装備を持ち込むリスクを天秤にかける
```

#### フェーズ 3: 終盤（残機1）

**目標:** 深層到達

```
- 最高の装備とデッキで挑む
- 深度5（深淵）に到達
- 残機1での挑戦は生死を分ける
- ボス撃破で脱出ルートが開く
```

---

### 3.3 エンディング条件

**成功条件:**

```
深度5のボスを撃破し、脱出ルートで生還
```

**失敗条件:**

```
残機0の状態で死亡 → ゲームオーバー
```

**ゲームオーバー時:**

```
完全リセット:
- Gold: 初期値に戻る
- 装備: 初期装備のみ
- 魂の残滓（累計）: 0に戻る
- Sanctuary解放状況: リセット
- カードデッキ: 初期デッキに戻る
- 図鑑記録: リセット
- 既知イベント情報: リセット

継続されるもの:
- 実績解除状況のみ
```

---

## 4. 各システムの役割（再定義）

### 4.1 BaseCamp 施設の再定義

#### Guild（酒場）

**役割:** ゲームの起点

- キャラクター選択
- 残機の確認
- 現在の状況サマリー

#### Shop（取引所）

**役割:** 装備調達の中心

- 装備購入（Gold 消費）
- 装備売却（不要装備の換金）
- 魔石 →Gold 換金

#### Blacksmith（鍛冶屋）

**役割:** 装備の極限強化

- レベルアップ（Lv0-3）
- 品質上昇（ガチャ要素）
- 修理（AP 回復）
- 解体（魔石還元）

**戦略:**

- 高レベル装備はリスクが高いが強力
- 品質ガチャで最高品質を狙うか

#### Sanctuary（神殿）

**役割:** 魂の残滓による恒久強化

**V3.0での変更:**

```
旧: 生還時に魂加算、死亡時は探索分ゼロ
新: 生還・死亡問わず魂100%加算
```

**スキルツリー:**

- 基礎ステータス強化（HP/Gold）
- 特殊能力（鑑定/拡張）
- ※探索回数拡張スキルは削除

#### Library（図書館）

**役割:** ビルド研究・記録管理

- デッキ編成
- 装備セット保存
- 図鑑（カード/装備/魔物）
- セーブ/ロード

#### Dungeon Gate（深淵の入口）

**役割:** 探索開始

- 深度選択
- 残機確認
- **転移石の所持確認**

---

### 4.2 リソースエコノミーの再設計

#### Gold の流れ

```
【獲得】
1. 魔石・装備をbaseCamp内での売却

2. Dungeon探索 → イベント発生(未実装)
              ↓
         生還 → BaseCampに持ち帰り
              ↓
         死亡 → ゼロ（ロスト）

【消費】
BaseCamp:
- Shop: 装備購入
- Blacksmith: 強化・修理
```

#### 魔石の流れ

```
【獲得】
1. Dungeon探索 → 魔物ドロップ
              ↓
   イベント発生 → 魔石入手
              ↓
         生還 → BaseCampに持ち帰り
              ↓
         死亡 → ゼロに（ロスト）

【消費】
- Blacksmith: 装備強化
- Shop: Gold換金（緊急時）
```

#### 魂の残滓の流れ

```
【獲得】
Dungeon探索 → 魔物撃破 → 魂獲得（経験値的）
              ↓
         生還 → 累計に100%加算（恒久）
              ↓
         死亡 → 累計に100%加算（恒久）★V3.0変更

【消費】
- Sanctuary: スキルツリー解放
```

**重要な設計（V3.0）:**

- 魂の残滓は**生還・死亡問わず100%獲得**
- 死亡のペナルティは「残機減少」と「アイテムロスト」
- 成長要素（魂）は確保されるため、完全な無駄死にはない

---

## 5. 難易度設計の方針

### 5.1 難易度曲線

```
深度1: チュートリアル的な難易度
      雑魚敵のみ、装備なしでもクリア可能

深度2: 基礎装備が必要
      装備Lv0-1でクリア可能

深度3: 戦略が必要
      装備Lv1-2 + デッキ構成の最適化

深度4: 高難度
      装備Lv2-3 + 品質good以上推奨

深度5: 最高難度
      最高装備 + 最適デッキ + Sanctuary強化必須
```

### 5.2 死亡ペナルティのバランス

**設計目標:**

- 死亡は非常に痛いが、成長は止まらない
- 慎重なプレイを促す
- 装備持ち込みのリスク管理を重視

**調整ポイント:**

```
死亡ペナルティの重さ = 持ち込んだ装備の価値 + 獲得したリソース + 残機1

序盤: 装備の価値が低い → ペナルティ小
中盤: 装備の価値が上がる → ペナルティ中
終盤: 最高装備を持ち込む → ペナルティ大
```

### 5.3 残機システムのバランス

**目標:**

- 慎重なプレイヤー: 残機を温存して深度5到達
- 平均的なプレイヤー: 残機1-2で深度5挑戦
- 無謀なプレイヤー: 残機0でゲームオーバー

---

## 6. プレイヤー体験の設計

### 6.1 目指すプレイ体験

**緊張感:**

- 「この装備を持ち込むべきか」
- 「もう一歩進むか、ここで帰るか」
- 「残機があと1つしかない」

**達成感:**

- 「無事に生還できた！」
- 「高レベル装備を持ち帰れた！」
- 「深度5に到達した！」

**戦略性:**

- 装備の選択と持ち込みリスク
- 帰還のタイミング
- デッキ構成
- スキルツリーの選択

### 6.2 プレイヤーの選択肢

**探索前:**

```
[1] どの装備を持ち込むか
    - 高レベル装備（リスク大、リターン大）
    - 低レベル装備（リスク小、リターン小）
    - 装備なし（死亡時ロストなし、クリア困難）

[2] どのデッキで挑むか
    - 攻撃特化
    - 防御重視
    - バランス型

[3] どの深度に挑むか
    - 深度1-2（安全、報酬少）
    - 深度3-4（危険、報酬中）
    - 深度5（最危険、報酬大）
```

**探索中:**

```
[1] 戦闘後の選択
    - 次の部屋へ進む
    - 転移石で帰還
    - 帰還ルートで帰還

[2] 装備が手に入った
    - 装備して続行（死亡時ロスト増）
    - 持ち帰り優先で帰還

[3] HP残量の判断
    - まだ戦える → 深層へ
    - 危険水域 → 帰還
```

---

## 7. ゲームフロー全体図

```
┌─────────────────────────────────────────────┐
│  ゲーム開始                                  │
│  - 残機: 3（Normal/Easy）or 2（Hard）        │
│  - 魂の残滓: 0                               │
│  - Gold: 500                                 │
└──────────────┬──────────────────────────────┘
               ↓
┌─────────────────────────────────────────────┐
│  BaseCamp（準備）                            │
│  - Shop: 初期装備購入                        │
│  - Library: デッキ構築                       │
│  - Blacksmith: 装備強化                      │
│  - Sanctuary: スキルツリー（魂があれば）     │
└──────────────┬──────────────────────────────┘
               ↓
         Dungeon探索
               ↓
    ┌──────────┴──────────┐
    │                     │
  生還                  死亡
    │                     │
    ↓                     ↓
全て持ち帰り          全ロスト
残機変化なし          魂100%獲得
    │                 残機-1
    │                     │
    └──────────┬──────────┘
               ↓
         残機 > 0?
         │        │
        Yes       No
         │        ↓
         │    ゲームオーバー
         │    （完全リセット）
         ↓
    BaseCampに戻る
         ↓
    深度5クリア?
         │        │
        No        Yes
         │        ↓
         └──→  エンディング
               （成功）
```

---

## 8. 設計の優先順位

### 8.1 Phase 1（MVP）

**目標:** 基本ループの実装

```
□ BaseCamp基本機能（Guild/Shop/Blacksmith/sanctuary）
□ Dungeon探索（深度1-3）
□ 生還・死亡システム
□ 残機システム
□ 魂の残滓（経験値）システム
□ 基本的なSanctuaryスキルツリー
```

### 8.2 Phase 2（拡張）

**目標:** 戦略性の追加

```
□ Blacksmith品質ガチャ
□ Library図鑑・デッキ編成
□ カード熟練度システム
□ Sanctuaryスキルツリー拡張
□ 深度4-5の実装
□ 深淵脱出ルート
```

### 8.3 Phase 3（完成）

**目標:** バランス調整と演出

```
□ 難易度調整
□ 残機バランス調整
□ 演出・アニメーション
□ UI/UX最適化
□ エンディング実装
```

---

## 9. 参照ドキュメント

```
GAME_DESIGN_MASTER_V3 [本文書]
├── BASE_CAMP_DESIGN_V2（要修正）
│   ├── GUILD_DESIGN_V2.1
│   ├── SHOP_DESIGN_V1（要修正）
│   ├── BLACKSMITH_DESIGN_V1
│   ├── SANCTUARY_DESIGN_V3（V3.0対応版）
│   └── LIBRARY_DESIGN_V1
├── battle_logic.md
├── card_system.md
├── return_system_v3.md（V3.0対応版）
└── dungeon_system.md
```

**次のステップ:**

1. return_system_design.md の更新（転移石統一、脱出ルート）
2. sanctuary_design.md の更新（魂100%獲得）
3. dungeon_exploration_ui_design.md の更新（残機表示）

---

## まとめ

### 新しいゲーム設計の核心（V3.0）

**ジャンル:**

> 持ち帰り型ダンジョン RPG × カードバトル

**コアメカニクス:**

> 生還 or 死亡の選択 + 残機システム

**残機システムの特徴:**

1. 死亡時のみ残機減少
2. 帰還成功時は残機温存
3. 難易度別上限（Hard:2, Normal/Easy:3）
4. 残機回復手段なし
5. 残機0でゲームオーバー（完全リセット）

**死亡ペナルティの特徴:**

1. 所有アイテム・装備全ロスト
2. 獲得Gold全ロスト
3. **魂の残滓は100%獲得**
4. 残機-1

**3 つの成長軸:**

1. 装備の成長（リスク・リターン）
2. カードの成長（恒久）
3. 魂の残滓（経験値・恒久）

**プレイヤー体験:**

> 「装備を持ち込むべきか」のリスク判断
> 「もう一歩進むか、帰るか」のジレンマ
> 残機システムによる緊張感
> 生還の達成感
